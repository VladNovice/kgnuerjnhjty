<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>INVESTCOIN Calculator — Glass iPhone Style</title>
  <style>
    :root {
      --bg: #060616;
      --glass-1: rgba(255,255,255,0.04);
      --glass-2: rgba(255,255,255,0.02);
      --muted: rgba(255,255,255,0.55);
      --muted-2: rgba(168,178,209,0.35);
      --accent: rgba(255,255,255,0.06);
      --accent-strong: rgba(255,255,255,0.09);
      --success: #10B981;
      --danger: #EF4444;
      --border: rgba(255,255,255,0.06);
      --radius: 20px;
      --glass-blur: 10px;
      font-synthesis: none;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; }
    body {
      min-height: 100vh;
      font-family: -apple-system, BlinkMacSystemFont, 'Inter', 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(180deg, #050513 0%, #0a0e1a 100%);
      color: white;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 28px;
    }

    /* Container: emulate centered iPhone app card */
    .container {
      width: 100%;
      max-width: 940px;
      border-radius: 34px;
      padding: 28px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.04);
      box-shadow: 0 10px 40px rgba(2,6,23,0.65);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      overflow: hidden;
    }

    header.header {
      display: flex;
      gap: 18px;
      align-items: center;
      padding-bottom: 18px;
      border-bottom: 1px solid rgba(255,255,255,0.03);
    }

    .logo-icon {
      width: 64px;
      height: 64px;
      border-radius: 16px;
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
      display: flex;
      align-items: center;
      justify-content: center;
      border: 1px solid var(--border);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
    }
    .logo-icon img { width: 86%; height: 86%; object-fit: contain; border-radius: 10px; }

    .header-text h1 {
      font-size: 1.5rem;
      font-weight: 700;
      letter-spacing: -0.02em;
      color: white;
    }
    .header-text p { color: var(--muted-2); font-size: 0.88rem; margin-top: 4px; }

    nav.main-nav {
      display: flex;
      gap: 10px;
      margin: 20px 0;
      background: transparent;
    }

    .nav-btn {
      flex: 1;
      padding: 10px 14px;
      border-radius: 14px;
      border: 1px solid transparent;
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
      color: var(--muted);
      font-weight: 600;
      font-size: 0.95rem;
      cursor: pointer;
      transition: background 120ms ease, color 120ms ease, border-color 120ms ease;
    }

    .nav-btn.active {
      color: white;
      background: linear-gradient(180deg, rgba(255,255,255,0.022), rgba(255,255,255,0.01));
      border-color: rgba(255,255,255,0.04);
    }

    main.main-content { padding-bottom: 8px; }
    .section { display: none; }
    .section.active { display: block; }

    .grid { display: grid; gap: 12px; }
    .grid-2 { grid-template-columns: 1fr 1fr; }

    input, select {
      width: 100%;
      padding: 14px;
      border-radius: 14px;
      background: linear-gradient(180deg, var(--glass-2), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.03);
      color: white;
      font-size: 0.98rem;
      outline: none;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.02);
      transition: box-shadow 100ms ease, border-color 100ms ease;
      -webkit-appearance: none;
    }
    input:focus, select:focus {
      border-color: rgba(255,255,255,0.06);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.03), 0 6px 18px rgba(2,6,23,0.45);
    }
    ::placeholder { color: rgba(255,255,255,0.35); }

    /* Buttons: flatter, glassy */
    .btn {
      padding: 12px 18px;
      border-radius: 14px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.04);
      color: white;
      font-weight: 700;
      cursor: pointer;
      transition: background 120ms ease, opacity 120ms ease;
      box-shadow: none;
    }
    .btn:hover { opacity: 0.95; }
    .btn:active { opacity: 0.92; }

    .results {
      margin-top: 18px;
      padding: 18px;
      border-radius: 14px;
      background: linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.008));
      border: 1px solid rgba(255,255,255,0.03);
      color: var(--muted);
    }
    .results div { padding: 6px 0; border-bottom: 1px solid rgba(255,255,255,0.02); }
    .results div:last-child { border-bottom: none; }

    .actions { margin-top: 22px; display: grid; gap: 12px; }
    .btn-block {
      display: flex; gap: 12px; align-items: center; padding: 14px; border-radius: 14px;
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.008));
      border: 1px solid rgba(255,255,255,0.03);
      cursor: pointer;
      transition: opacity 120ms ease;
    }
    .btn-block:hover { opacity: 0.98; }
    .btn-block img, .btn-block svg { width: 44px; height: 44px; border-radius: 10px; padding: 6px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); }

    .brand-logo { background: none; padding: 0; }
    .btn-content span { font-weight: 700; display: block; color: white; }
    .btn-desc { color: var(--muted-2); font-size: 0.9rem; }

    .entry-item { display: grid; grid-template-columns: 1fr 1fr auto; gap: 10px; align-items: center; margin-top: 10px; }

    /* Modal: glass */
    .modal { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; z-index: 999; }
    .modal.active { display: flex; }
    .modal::before { content: ''; position: absolute; inset: 0; background: rgba(2,6,23,0.6); backdrop-filter: blur(6px); -webkit-backdrop-filter: blur(6px); }
    .modal-content {
      position: relative; z-index: 2; width: 100%; max-width: 520px; border-radius: 18px; padding: 22px; color: white;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.03);
      box-shadow: 0 30px 60px rgba(2,6,23,0.6);
      backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
    }
    .modal-content h3 { color: white; margin-bottom: 12px; }
    .modal-content p, .modal-content ul { color: var(--muted-2); margin-bottom: 10px; }
    .modal-actions { display: flex; gap: 10px; justify-content: flex-end; margin-top: 12px; }

    footer.footer { text-align: center; color: var(--muted-2); font-size: 0.88rem; margin-top: 16px; }

    /* Responsive small screens */
    @media (max-width: 600px) {
      .grid-2 { grid-template-columns: 1fr; }
      .logo-icon { width: 56px; height: 56px; }
      .container { padding: 18px; border-radius: 22px; }
    }

  </style>
</head>
<body>
  <div class="container" role="application">
    <header class="header">
      <div class="logo-icon">
        <img src="logo.png" alt="INVESTCOIN Logo" />
      </div>
      <div class="header-text">
        <h1>INVESTCOIN Calculator</h1>
        <p>Профессиональный расчёт позиций для трейдинга</p>
      </div>
    </header>

    <nav class="main-nav" aria-label="Главная навигация">
      <button class="nav-btn active" onclick="showSection('avg', event)">Средняя точка</button>
      <button class="nav-btn" onclick="showSection('risk', event)">Риск/Объём</button>
    </nav>

    <main class="main-content">
      <section id="avg" class="section active" aria-labelledby="avg-heading">
        <div class="grid">
          <div class="grid grid-2">
            <input type="number" id="newEntryPrice" placeholder="Цена входа" step="0.0001" min="0.0001" />
            <input type="number" id="newEntryAmount" placeholder="Объём" step="0.0001" min="0.0001" />
          </div>
          <div class="grid grid-2">
            <button class="btn" onclick="addEntry()">+ Добавить точку</button>
            <button class="btn" onclick="calculateAvg()">Рассчитать среднюю</button>
          </div>
          <div id="entries"></div>
        </div>
        <div id="avgResult" class="results" aria-live="polite"></div>
      </section>

      <section id="risk" class="section" aria-labelledby="risk-heading">
        <div class="grid">
          <select id="positionType">
            <option value="long">Long</option>
            <option value="short">Short</option>
          </select>
          <input type="number" id="deposit" placeholder="Депозит ($)" min="0.01" step="0.01" />
          <input type="number" id="riskPercent" placeholder="Риск (%)" step="0.1" min="0.1" max="100" />
          <input type="number" id="entryPrice" placeholder="Цена входа" step="0.0001" min="0.0001" />
          <input type="number" id="stopLoss" placeholder="Стоп-лосс" step="0.0001" min="0.0001" />
          <input type="number" id="takeProfit" placeholder="Тейк-профит (необязательно)" step="0.0001" min="0.0001" />
          <button class="btn" onclick="calculateRisk()">Рассчитать риск</button>
        </div>
        <div id="riskResult" class="results" aria-live="polite"></div>
      </section>
    </main>

    <div class="actions">
      <div class="btn-block" onclick="window.open('https://t.me/investcoin_free','_blank')" role="link" aria-label="INVESTCOIN Telegram">
        <img src="https://cdn.jsdelivr.net/npm/simple-icons@v6/icons/telegram.svg" alt="Telegram логотип" />
        <div class="btn-content"><span>INVESTCOIN</span><div class="btn-desc">Инвестиции и криптовалюта</div></div>
      </div>

      <div class="btn-block" onclick="window.open('https://partner.bybit.com/b/23588','_blank')" role="link" aria-label="Bybit">
        <img src="https://upload.wikimedia.org/wikipedia/commons/1/14/Bybit_Logo.svg" alt="Bybit логотип" />
        <div class="btn-content"><span>Bybit</span><div class="btn-desc">Регистрация по партнёрской ссылке (код: 23588)</div></div>
      </div>

      <div class="btn-block" onclick="window.open('https://bingx.com/invite/INVESTCOIN/','_blank')" role="link" aria-label="BingX">
        <svg id="bingxLogo" class="brand-logo" viewBox="0 0 100 100" width="44" height="44" role="img" aria-label="BingX логотип">
          <title>BingX</title>
          <defs>
            <linearGradient id="bingxGrad" x1="0" x2="1" y1="0" y2="1">
              <stop offset="0" stop-color="#1A2F4A"/>
              <stop offset="0.55" stop-color="#24436B"/>
              <stop offset="1" stop-color="#2B4F7D"/>
            </linearGradient>
          </defs>
          <rect x="0" y="0" width="100" height="100" rx="20" fill="url(#bingxGrad)"></rect>
          <g transform="translate(18,12) scale(0.7)" fill="#FFFFFF" fill-opacity="0.98">
            <path d="M12 36 L32 12 L54 36 L32 60 Z"></path>
            <path d="M64 24 L76 24 L76 40 L64 40 Z"></path>
          </g>
        </svg>
        <div class="btn-content">
          <span>BingX</span>
          <div class="btn-desc">Регистрация по партнёрской ссылке (код: INVESTCOIN)</div>
        </div>
      </div>

      <div class="btn-block" onclick="showModal('clubModal')">
        <img src="https://unpkg.com/heroicons@2.0.13/24/outline/users.svg" alt="Клуб логотип" />
        <div class="btn-content"><span>Закрытый торговый клуб</span><div class="btn-desc">Аналитика и торговые сигналы</div></div>
      </div>
    </div>

    <div class="modal" id="clubModal">
      <div class="modal-content">
        <h3>Как попасть в закрытый клуб?</h3>
        <p>Доступ в закрытый клуб возможен по подписке ИЛИ для моих активных рефералов абсолютно бесплатно.</p>
        <ul>
          <li>По подписке: 50 $/мес.</li>
          <li>Рефералам: регистрация на бирже Bybit или BingX по моей партнёрской ссылке, депозит от 300 $ и активность.</li>
        </ul>
        <p>Если у вас уже есть аккаунт Bybit или BingX, вы можете перенести его под мою ссылку. Напишите мне в личные сообщения, и я расскажу, как это сделать.</p>
        <p><strong>Для вступления в клуб:</strong> <a href="https://t.me/csklad_bot" target="_blank" rel="noopener">@csklad_bot</a></p>
        <div class="modal-actions">
          <button class="btn" onclick="window.open('https://partner.bybit.com/b/23588','_blank')">Регистрация Bybit</button>
          <button class="btn" onclick="window.open('https://bingx.com/invite/INVESTCOIN/','_blank')">Регистрация BingX</button>
          <button class="btn" onclick="hideModal('clubModal')">Закрыть</button>
        </div>
      </div>
    </div>

    <footer class="footer">© INVESTCOIN Calculator, 2025</footer>
  </div>

  <script>
    /* --- JS оставлен почти без изменений. Убраны визуальные анимации в CSS, поэтому JS остаётся работоспособным --- */
    let entries = [];

    function addEntry() {
      const price = parseFloat(document.getElementById('newEntryPrice').value);
      const amount = parseFloat(document.getElementById('newEntryAmount').value);
      if (isNaN(price) || price <= 0 || isNaN(amount) || amount <= 0) {
        alert('Введите корректные положительные значения для цены и объёма');
        return;
      }
      if (entries.length >= 5) { alert('Максимум 5 точек входа'); return; }
      entries.push({ price, amount });
      document.getElementById('newEntryPrice').value = '';
      document.getElementById('newEntryAmount').value = '';
      renderEntries();
    }

    function renderEntries() {
      const container = document.getElementById('entries'); container.innerHTML = '';
      entries.forEach((e, i) => {
        const div = document.createElement('div'); div.className = 'entry-item';
        div.innerHTML = `\n          <input type="number" value="${e.price}" step="0.0001" readonly />\n          <input type="number" value="${e.amount}" step="0.0001" readonly />\n          <button class="btn" onclick="removeEntry(${i})">Удалить</button>\n        `;
        container.appendChild(div);
      });
    }

    function removeEntry(idx) { entries.splice(idx, 1); renderEntries(); }

    function calculateAvg() {
      if (entries.length === 0) { alert('Добавьте хотя бы одну точку входа'); return; }
      const totalValue = entries.reduce((sum, e) => sum + e.price * e.amount, 0);
      const totalAmount = entries.reduce((sum, e) => sum + e.amount, 0);
      const avg = totalValue / totalAmount;
      const avgRes = document.getElementById('avgResult');
      avgRes.textContent = `Средняя точка входа: ${avg.toFixed(4)} (${entries.length} позиций)`;
      avgRes.style.display = 'block';
    }

    function calculateRisk() {
      const positionType = document.getElementById('positionType').value;
      let deposit = parseFloat(document.getElementById('deposit').value);
      let riskPercent = parseFloat(document.getElementById('riskPercent').value);
      let entryPrice = parseFloat(document.getElementById('entryPrice').value);
      let stopLoss = parseFloat(document.getElementById('stopLoss').value);
      const tpInput = document.getElementById('takeProfit').value;
      let takeProfit = tpInput ? parseFloat(tpInput) : null;

      if (isNaN(deposit) || deposit <= 0) { alert('Введите корректный депозит (> 0)'); return; }
      if (isNaN(riskPercent) || riskPercent <= 0 || riskPercent > 100) { alert('Введите корректный риск в % (0 < % ≤ 100)'); return; }
      if (isNaN(entryPrice) || entryPrice <= 0) { alert('Введите корректную цену входа (> 0)'); return; }
      if (isNaN(stopLoss) || stopLoss <= 0) { alert('Введите корректный стоп-лосс (> 0)'); return; }

      if (takeProfit !== null) {
        if (positionType === 'long' && stopLoss > entryPrice && takeProfit < entryPrice) {
          [stopLoss, takeProfit] = [takeProfit, stopLoss];
          alert('Стоп-лосс и тейк-профит были переставлены местами.');
        }
        if (positionType === 'short' && stopLoss < entryPrice && takeProfit > entryPrice) {
          [stopLoss, takeProfit] = [takeProfit, stopLoss];
          alert('Стоп-лосс и тейк-профит были переставлены местами.');
        }
      }

      if (positionType === 'long' && stopLoss >= entryPrice) { alert('Для Long стоп-лосс должен быть ниже цены входа'); return; }
      if (positionType === 'short' && stopLoss <= entryPrice) { alert('Для Short стоп-лосс должен быть выше цены входа'); return; }

      if (takeProfit !== null) {
        if (isNaN(takeProfit) || takeProfit <= 0) { alert('Введите корректный тейк-профит (> 0) или оставьте поле пустым'); return; }
        if (positionType === 'long' && takeProfit <= entryPrice) { alert('Для Long тейк-профит должен быть выше цены входа'); return; }
        if (positionType === 'short' && takeProfit >= entryPrice) { alert('Для Short тейк-профит должен быть ниже цены входа'); return; }
      }

      const riskAmount = deposit * (riskPercent / 100);
      const stopDiff = Math.abs(entryPrice - stopLoss);
      const contractSize = riskAmount / stopDiff;
      let profitAmount = null;
      if (takeProfit !== null) {
        profitAmount = contractSize * Math.abs(takeProfit - entryPrice);
      }

      const riskRes = document.getElementById('riskResult');
      let html = `\n        <div>Размер позиции: ${contractSize.toFixed(4)} монет</div>\n        <div style=\"color: ${'var(--danger)'}\">Максимальный риск: ${riskAmount.toFixed(2)} $</div>\n      `;
      if (profitAmount !== null) html += `<div style=\"color: ${'var(--success)'}\">Потенциальный профит: ${profitAmount.toFixed(2)} $</div>`;
      riskRes.innerHTML = html; riskRes.style.display = 'block';
    }

    function showSection(id, e) {
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
      document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      if (e && e.target) e.target.classList.add('active');
      document.getElementById('avgResult').style.display = 'none';
      document.getElementById('riskResult').style.display = 'none';
    }

    function showModal(id) { document.getElementById(id).classList.add('active'); }
    function hideModal(id) { document.getElementById(id).classList.remove('active'); }

    (function(){
      const container = document.getElementById('bingxContainer');
      if (!container) return;
      const imgUrl = 'bingx.jpg';
      const testImg = new Image();
      testImg.onload = function() {
        testImg.width = 44;
        testImg.height = 44;
        testImg.alt = 'BingX логотип';
        testImg.id = 'bingxImg';
        testImg.style.borderRadius = '12px';
        testImg.style.padding = '8px';
        testImg.style.objectFit = 'contain';
        testImg.className = '';
        container.replaceWith(testImg);
      };
      testImg.onerror = function() {};
      testImg.src = imgUrl;
    })();
  </script>
</body>
</html>
